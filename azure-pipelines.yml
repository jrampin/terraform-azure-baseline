trigger:
- main

pool:
  vmImage: ubuntu-latest

#variables:
#  ARM_ACCESS_KEY: '$(ARM_ACCESS_KEY)'
#  ARM_CLIENT_ID: '$(ARM_CLIENT_ID)'
#  ARM_CLIENT_SECRET: '$(ARM_CLIENT_SECRET)'
#  ARM_SUBSCRIPTION_ID: '$(ARM_SUBSCRIPTION_ID)'
#  ARM_TENANT_ID: '$(ARM_TENANT_ID)'

steps:
- script: | 
    curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -
    sudo apt-add-repository "deb [arch=amd64] https://apt.releases.hashicorp.com $(lsb_release -cs) main"
    sudo apt-get update && sudo apt-get install terraform
  displayName: 'Install Terraform'

- script: |
    terraform version
  displayName: 'Check Terraform Version'

- script: |
    cd terraform/environments/dev
    ls -lah
    terraform init
    terraform plan
  displayName: 'Change directory and test terraform init'
